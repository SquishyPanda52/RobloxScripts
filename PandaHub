-- TPUA Executor Script

local Players     = game:GetService("Players")
local RunService  = game:GetService("RunService")
local CoreGui     = game:GetService("CoreGui")

-- Global toggle state
getgenv().TPUA_ENABLED = getgenv().TPUA_ENABLED or false

-- Create UI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "TPUA_GUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = CoreGui

local frame = Instance.new("Frame")
frame.Name = "TPUA_Frame"
frame.Size = UDim2.new(0, 140, 0, 40)
frame.Position = UDim2.new(0, 10, 0, 10)
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
frame.BorderSizePixel = 0
frame.Parent = screenGui

local button = Instance.new("TextButton")
button.Name = "TPUA_Button"
button.Size = UDim2.new(1, -10, 1, -10)
button.Position = UDim2.new(0, 5, 0, 5)
button.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
button.BorderSizePixel = 0
button.Font = Enum.Font.SourceSansBold
button.TextSize = 18
button.TextColor3 = Color3.new(1, 1, 1)
button.Text = "TPUA: Off"
button.Parent = frame

-- Toggle handler
button.MouseButton1Click:Connect(function()
    getgenv().TPUA_ENABLED = not getgenv().TPUA_ENABLED
    button.Text = getgenv().TPUA_ENABLED and "TPUA: On" or "TPUA: Off"
end)

-- Continuous teleport loop
spawn(function()
    while true do
        if getgenv().TPUA_ENABLED then
            local lp  = Players.LocalPlayer
            local char = lp and lp.Character
            local hrp  = char and char:FindFirstChild("HumanoidRootPart")
            if hrp then
                for _, obj in ipairs(workspace:GetDescendants()) do
                    if obj:IsA("BasePart") and not obj.Anchored then
                        -- Protect against nils or errors
                        pcall(function()
                            obj.CFrame = hrp.CFrame
                        end)
                    end
                end
            end
        end
        RunService.Heartbeat:Wait()
    end
end)
